# /opt/ollama-multi/config/nginx.conf
events {
    worker_connections 1024;
}

http {
    # HR Department
    server {
        listen 80;
        server_name hr.ollama.local;
        
        location / {
            proxy_pass http://webui-hr:8080;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            
            # WebSocket support
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
        }
    }
    
    # Health Department
    server {
        listen 80;
        server_name health.ollama.local;
        
        location / {
            proxy_pass http://webui-health:8080;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
        }
    }
    
    # Development Department
    server {
        listen 80;
        server_name dev.ollama.local;
        
        location / {
            proxy_pass http://webui-development:8080;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            
            proxy_http_version 1.1;
            proxy_set_header Upgrade $http_upgrade;
            proxy_set_header Connection "upgrade";
        }
    }
    
    # Main landing page
    server {
        listen 80 default_server;
        server_name _;
        
        return 200 '
<!DOCTYPE html>
<html>
<head><title>Department AI Services</title></head>
<body>
    <h1>AI Services by Department</h1>
    <ul>
        <li><a href="http://hr.ollama.local">HR Department</a> (Port 3000)</li>
        <li><a href="http://health.ollama.local">Health Department</a> (Port 3001)</li>
        <li><a href="http://dev.ollama.local">Development Department</a> (Port 3002)</li>
        <li><a href="http://your-server:9090">Monitoring</a></li>
    </ul>
</body>
</html>';
        add_header Content-Type text/html;
    }
}
